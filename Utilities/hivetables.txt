CREATE EXTERNAL TABLE centros_comerciales
(
tipo VARCHAR(100), 
calle VARCHAR(100), 
numero VARCHAR(100),
colonia VARCHAR(100),
codigo_postal VARCHAR(100),  
alcaldia VARCHAR(100)
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
STORED AS TEXTFILE
location '/user/irojasgo/centros_comerciales_hive'
;

CREATE EXTERNAL TABLE consumo_agua_bimestral
(
cve_ent VARCHAR(100), 
alcaldia VARCHAR(100), 
cve_col VARCHAR(100),
colonia VARCHAR(100), 
objectid VARCHAR(100),
frequency VARCHAR(100), 
sum_cons_t VARCHAR(100),
mean_cons VARCHAR(100),
viv2010 VARCHAR(100),
promvivcon VARCHAR(100), 
c_promvivc VARCHAR(100)
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
STORED AS TEXTFILE
location '/user/irojasgo/consumo_agua_bimestral_hive'
;

CREATE EXTERNAL TABLE hogares_por_colonia
(
cve_ent VARCHAR(100), 
alcaldia VARCHAR(100),
cve_col VARCHAR(100),
colonia VARCHAR(100), 
vivhab2010 VARCHAR(100), 
vivhab2020 VARCHAR(100),
area_ha VARCHAR(100), 
denviv10 VARCHAR(100),
denviv20 VARCHAR(100),
sum_tothog VARCHAR(100)
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
STORED AS TEXTFILE
location '/user/irojasgo/hogares_por_colonia_hive'
;

CREATE EXTERNAL TABLE poblacion_disponibilidad_agua_vivienda
(
alcaldia VARCHAR(100),
clave VARCHAR(100),
poblacion VARCHAR(100), 
poblacion_agua_patio VARCHAR(100), 
porcentaje_poblacion_agua_patio VARCHAR(100),
poblacion_no_agua_entubada VARCHAR(100), 
porcentaje_poblacion_no_agua_entubada VARCHAR(100),
poblacion_agua_pipa VARCHAR(100),
porcentaje_poblacion_agua_pipa VARCHAR(100)
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
STORED AS TEXTFILE
location '/user/irojasgo/poblacion_disponibilidad_agua_vivienda_hive'
;

CREATE EXTERNAL TABLE poblacion_total
(
anio VARCHAR(100),
alcaldia VARCHAR(100),
poblacion_total VARCHAR(100)
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
STORED AS TEXTFILE
location '/user/irojasgo/poblacion_total_hive'
;

CREATE EXTERNAL TABLE ue_comerciales
(
nombre VARCHAR(100),
entidad VARCHAR(100),
cve_alc VARCHAR(100),
alcaldia VARCHAR(100),
cve_col VARCHAR(100),
ue VARCHAR(100),
ind VARCHAR(100),
com VARCHAR(100),
sup_ha VARCHAR(100)
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
STORED AS TEXTFILE
location '/user/irojasgo/ue_comerciales_hive'
;


drop table centros_comerciales;
drop table consumo_agua_bimestral;
drop table hogares_por_colonia;
drop table poblacion_disponibilidad_agua_vivienda;
drop table poblacion_total;
drop table ue_comerciales;





load data inpath '/user/irojasgo/centros_comerciales/part-m-*' into table centros_comerciales;
load data inpath '/user/irojasgo/consumo_agua_bimestral/part-m-*' into table consumo_agua_bimestral;
load data inpath '/user/irojasgo/hogares_por_colonia/part-m-*' into table hogares_por_colonia;
load data inpath '/user/irojasgo/poblacion_disponibilidad_agua_vivienda/part-m-*' into table poblacion_disponibilidad_agua_vivienda;
load data inpath '/user/irojasgo/poblacion_total/part-m-*' into table poblacion_total;
load data inpath '/user/irojasgo/ue_comerciales/part-m-*' into table ue_comerciales;



